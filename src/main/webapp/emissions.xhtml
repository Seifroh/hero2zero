<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Hero to Zero – CO₂-Emissionen</title>
        <meta charset="UTF-8"/>
        <link rel="stylesheet"
              href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
              integrity="sha384-…" crossorigin="anonymous"/>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    </h:head>

    <h:body>
        <!-- Header mit Logo, Navigation -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light mb-4">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    <img src="#{request.contextPath}/resources/images/logo.png" alt="Hero2Zero" height="40"/>
                </a>
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <h:link outcome="emissions.xhtml" value="Home" styleClass="nav-link"/>
                    </li>
                    <li class="nav-item">
                        <h:link outcome="impressum.xhtml" value="Impressum" styleClass="nav-link"/>
                    </li>
                </ul>
            </div>
        </nav>

        <h:form id="mainForm" prependId="false">

            <!-- Kontinent-Buttons -->
            <div class="btn-group mb-3" role="group" aria-label="Kontinente">
                <h:commandButton value="Afrika"
                                 action="#{emissionBean.toggleContinent('Afrika')}"
                                 styleClass="#{emissionBean.selectedContinents.contains('Afrika') ? 'btn btn-primary' : 'btn btn-outline-primary'}" />
                <h:commandButton value="Antarktis"
                                 action="#{emissionBean.toggleContinent('Antarktis')}"
                                 styleClass="#{emissionBean.selectedContinents.contains('Antarktis') ? 'btn btn-primary' : 'btn btn-outline-primary'}" />
                <h:commandButton value="Asien"
                                 action="#{emissionBean.toggleContinent('Asien')}"
                                 styleClass="#{emissionBean.selectedContinents.contains('Asien') ? 'btn btn-primary' : 'btn btn-outline-primary'}" />
                <h:commandButton value="Europa"
                                 action="#{emissionBean.toggleContinent('Europa')}"
                                 styleClass="#{emissionBean.selectedContinents.contains('Europa') ? 'btn btn-primary' : 'btn btn-outline-primary'}" />
                <h:commandButton value="Nordamerika"
                                 action="#{emissionBean.toggleContinent('Nordamerika')}"
                                 styleClass="#{emissionBean.selectedContinents.contains('Nordamerika') ? 'btn btn-primary' : 'btn btn-outline-primary'}" />
                <h:commandButton value="Ozeanien"
                                 action="#{emissionBean.toggleContinent('Ozeanien')}"
                                 styleClass="#{emissionBean.selectedContinents.contains('Ozeanien') ? 'btn btn-primary' : 'btn btn-outline-primary'}" />
                <h:commandButton value="Suedamerika"
                                 action="#{emissionBean.toggleContinent('Suedamerika')}"
                                 styleClass="#{emissionBean.selectedContinents.contains('Suedamerika') ? 'btn btn-primary' : 'btn btn-outline-primary'}" />
                <h:commandButton value="Alle"
                                 action="#{emissionBean.clearContinents}"
                                 styleClass="btn btn-secondary" />
            </div>

            <!-- Suchfelder -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <h:outputLabel for="filterCountry" value="Land:" />
                    <h:inputText id="filterCountry" value="#{emissionBean.filterCountry}" styleClass="form-control" />
                </div>
                <div class="col-md-2">
                    <h:outputLabel for="filterCode" value="Code:" />
                    <h:inputText id="filterCode" value="#{emissionBean.filterCode}" styleClass="form-control" />
                </div>
                <div class="col-md-2">
                    <h:outputLabel for="filterYear" value="Jahr:" />
                    <h:inputText id="filterYear" value="#{emissionBean.filterYear}" maxlength="4" styleClass="form-control" />
                </div>
                <div class="col-md-3">
                    <h:outputLabel for="filterCO2" value="CO₂ (kt):" />
                    <h:inputText id="filterCO2" value="#{emissionBean.filterCo2}" styleClass="form-control" />
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <h:commandButton value="Suchen" action="#{emissionBean.filter}" styleClass="btn btn-primary w-100" />
                </div>
            </div>

            <!-- Datentabelle -->

            <h:panelGroup rendered="#{emissionBean.isFilterActive()}">
                <h:dataTable value="#{emissionBean.pageData}"
                             var="e"
                             border="1"
                             styleClass="table table-striped">
                    <h:column>
                        <f:facet name="header">ID</f:facet>
                            #{e.id}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Land</f:facet>
                            #{e.country}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Code</f:facet>
                            #{e.countryCode}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Jahr</f:facet>
                            #{e.year}
                    </h:column>
                    <h:column>
                        <f:facet name="header">CO₂ (kt)</f:facet>
                            #{e.co2Emissions}
                    </h:column>
                </h:dataTable>
            </h:panelGroup>

            <!-- Hinweis, wenn nichts gefiltert -->
            <h:panelGroup rendered="#{not emissionBean.isFilterActive()}">
                <div class="alert alert-info" role="alert">
                    Bitte wähle mindestens einen Kontinent oder nutze die Suche.
                </div>
            </h:panelGroup>


            <!-- NEU: Navigation + Seiteninfo nur bei Ergebnissen -->
            <h:panelGroup rendered="#{emissionBean.dataAvailable}">
                <div class="mt-3">
                    <h:commandButton value="Zurück"
                                     action="#{emissionBean.prevPage}"
                                     disabled="#{!emissionBean.hasPrev}"
                                     styleClass="btn btn-outline-secondary" />
                    <h:commandButton value="Weiter"
                                     action="#{emissionBean.nextPage}"
                                     disabled="#{!emissionBean.hasNext}"
                                     styleClass="btn btn-outline-secondary ms-2" />
                </div>

                <p class="mt-2 text-muted small">
                    Seite #{emissionBean.currentPageDisplay} von #{emissionBean.totalPages} –
                    Einträge insgesamt: #{emissionBean.totalEntries}
                </p>
            </h:panelGroup>
        </h:form>

    </h:body>
</html>
